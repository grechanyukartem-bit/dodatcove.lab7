<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–∏–Ω–∞–º—ñ—á–Ω–∞ —Ç–∞–±–ª–∏—Ü—è jQuery</title>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background-color: #f9f9f9; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #007bff; color: white; cursor: pointer; }
        th:hover { background-color: #0056b3; }
        .controls { margin-bottom: 20px; }
        button { 
            padding: 10px 15px; margin-right: 10px; cursor: pointer; 
            background-color: #28a745; color: white; border: none; border-radius: 4px;
        }
        button:hover { background-color: #218838; }
        #sortName, #sortAffiliation { background-color: #17a2b8; }
    </style>
</head>
<body>

    <h1>–°–ø–∏—Å–æ–∫ –ø–µ—Ä—Å–æ–Ω–∞–∂—ñ–≤ (AJAX + JSON)</h1>

    <div class="controls">
        <button id="loadData">üîÑ –û–Ω–æ–≤–∏—Ç–∏ –¥–∞–Ω—ñ</button>
        <button id="sortName">üî§ –°–æ—Ä—Ç—É–≤–∞—Ç–∏ –∑–∞ —ñ–º'—è–º</button>
        <button id="sortAffiliation">üõ°Ô∏è –°–æ—Ä—Ç—É–≤–∞—Ç–∏ –∑–∞ —Ñ—Ä–∞–∫—Ü—ñ—î—é</button>
    </div>

    <table id="charactersTable">
        <thead>
            <tr>
                <th>–Ü–º'—è (Name)</th>
                <th>–§—Ä–∞–∫—Ü—ñ—è (Affiliation)</th>
                <th>–†–∞–Ω–≥ (Rank)</th>
                <th>–õ–æ–∫–∞—Ü—ñ—è (Location)</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        $(document).ready(function() {
            let characterData = [];

            // –§—É–Ω–∫—Ü—ñ—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö
            function fetchData() {
                $.ajax({
                    url: 'data.json', // –í—ñ–¥–Ω–æ—Å–Ω–∏–π —à–ª—è—Ö –¥–æ —Ñ–∞–π–ª—É –≤ —Ç—ñ–π –∂–µ –ø–∞–ø—Ü—ñ
                    method: 'GET',
                    dataType: 'json',
                    cache: false, // –©–æ–± –±—Ä–∞—É–∑–µ—Ä –Ω–µ –∫–µ—à—É–≤–∞–≤ —Å—Ç–∞—Ä—ñ –¥–∞–Ω—ñ
                    success: function(data) {
                        characterData = data;
                        renderTable(characterData);
                        console.log("–î–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ");
                    },
                    error: function() {
                        alert('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è! –í—ñ–¥–∫—Ä–∏–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.');
                    }
                });
            }

            // –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ
            function renderTable(data) {
                const tbody = $('#charactersTable tbody');
                tbody.empty(); 
                $.each(data, function(index, item) {
                    tbody.append(`<tr>
                        <td>${item.name}</td>
                        <td>${item.affiliation}</td>
                        <td>${item.rank}</td>
                        <td>${item.location}</td>
                    </tr>`);
                });
            }

            // –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è
            function sortData(property) {
                if (characterData.length === 0) return;
                characterData.sort((a, b) => a[property].localeCompare(b[property]));
                renderTable(characterData);
            }

            // –ö–Ω–æ–ø–∫–∏
            $('#loadData').on('click', fetchData);
            $('#sortName').on('click', () => sortData('name'));
            $('#sortAffiliation').on('click', () => sortData('affiliation'));

            fetchData(); // –ü–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫
        });
    </script>
</body>
</html>
